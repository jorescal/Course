 

cd ~/Desktop/'IBM Course'/Github2/GitReps/Course







# First of all, create new Repo on Github

cd ~/Desktop/Github2/GitReps/	# create a new directory on your computer
mkdri Course			# every new directory needs to be create from the command line
cd Course 



git init
git config --global user.email "jorescal@gmail.com"


ls				# make sure you have the files you want to upload on the directory you are seeting


echo "# Data Science Course" >> README.md
git add README.md
git commit  -m "first commit of course notes xx/xx/2020"



git add 'IBM Course 5 Databases and SQL for Data Science.txt'
git add 'for_loops.ipynb'

git commit  -m "commit # upedate XX of course notes date xx/xx/2020"

for_loops.ipynb

git remote add origin git@github.com:jorescal/Course.git
git push -u origin master
















********** for every day update 


cd ~/Desktop/Github2/GitReps/Course


git add 'IBM Course 5 Databases and SQL for Data Science.txt'
git add 'for_loops.ipynb'
git commit  -m "commit # XX of course notes date xx/xx/2020"
git push 
















*********************** Week 1  - Databases and SQL for Data Science



When data is stored in tabular form, the data is organized in tables like in a spreadsheet, which are columns and rows. That's a relational database.A table is a collection of related things like a list of employees or a list of book authors. In a relational database, you can form relationships between tables.



A relational database stores data in a tabular format - i.e. in rows and columns. But not all types of databases use the tabular format.



We will discuss these 5 basic SQL queries in further detail in subsequent lessons:

CREATE

INSERT

SELECT

UPDATE

DELETE




* Data definition language or DDL statements are used to define, change, or drop data. it is used to create objects. The functions used on DDL are CREATE, DROP (It is quite common to issue a DROP before doing a CREATE in test and development scenarios.).

* Data manipulation language or DML statements are used to read and modify data. functions used on DML are SELECT (The SELECT statement is called a query, and the output we get from executing this query is called a result set or a result table.).



COUNT is a built-in database function that retrieves the number of rows that match the query criteria. select COUNT(*) from "tablename". 

DISTINCT is used to remove duplicate values from a result set.

LIMIT is used for restricting the number of rows retrieved from the database. Example, retrieve just the first 10 rows in a table. Select * from "tablename" LIMIT 10. Select * from MEDALS where YEAR = 2018 LIMIT 5.
















***********************  Examples to CREATE and DROP tables (DDL statement).



create a table:

drop table TABLENAME;

create table TABLENAME (
    
	COLUMN1 datatype,
    
	COLUMN2 datatype,
    
	COLUMN3 datatype,
       
	 ...
    
	) ;





Example:
	DROP TABLE country;

	CREATE TABLE country(
    
			id_Author INTEGER PRIMARY KEY (id_Author)NOT NULL,
    
			ccode CHAR(2),

			name VARCHAR(60)
 NOT NULL,
    
			);















*********************** The SELECT statement is called "query"( DML statement to read and modify ) 


How to use SELECT statement


	select COLUMN1, COLUMN2, ... from TABLE1 ;





Example:

	select ID, NAME from COUNTRY ;


To retrieve all columns from the COUNTRY table we could use "*" instead of specifying individual column names:

	select * from COUNTRY ;



The WHERE clause can be added to your query to filter results or get specific rows of data. To retrieve data for all rows in the COUNTRY table where the ID is less than 5:



	select * from COUNTRY where ID < 5 ;





In case of character based columns the values of the predicates in the where clause need to be enclosed in single quotes. To retrieve the data for the country with country code "CA" we would issue:

	select * from COUNTRY where CCODE = 'CA'; 

		or

	select ("columnname") from "tablename" where "columnname" =  "B1" ;
















*********************** Expressions that are used with "select" statements (COUNT, DISTINCT, LIMIT,    ). 



COUNT is a built-in database function that retrieves the number of rows that match the query criteria. For example, get the total number of rows in a given table: 


	select COUNT(*) from "tablename". 

		OR

	select DISTINCT ("columnname") from "tablename"

		
			example:Select COUNT(COUNTRY) from MEDALS 
					where COUNTRY='CANADA.' 




DISTINCT is used to remove duplicate values from a result set. Example, to retrieve unique values in a column, 



	select DISTINCT (*) from tablename. 

			OR

	select DISTINCT (columnname) from tablename. 


			example: select DISTINCT (COUNTRY) from MEDALS
					where COUNTRY='CANADA.' 


LIMIT is used for restricting the number of rows retrieved from the database. Example, retrieve just the first 10 rows in a table.

 
	Select * from tablename LIMIT XX. 

			example: Select * from MEDALS LIMIT 10. 















*********************** INSERT statement ( DML statement to read and modify)



The INSERT statement is used to add new rows to a table. The INSERT statement is one of the data manipulation language statements. Data manipulation language statements or DML statements are used to read and modify data.


The syntax of the INSERT statement looks like this, 

	INSERT INTO "table name", 
		(["column name", "column name", "column name", ...]), 
		VALUES
			(["A1", values, values, values, ...]),
			(["A2", values, values, values, ...]),
			...


In this statement, table name identifies the table, the column name list identifies each column in the table, and the values clause specifies the data values to be added to the columns in the table. 















*********************** UPDATE statement and the DELETE statement ( DML statement to read and modify). 



The syntax of the UPDATE statement looks like this, 


	UPDATE [TableName] SET [ColumnName] = [Value] ]> <WHERE [Condition] >. 


Example

	
	UPDATE author SET LasName = "katta" 
		WHERE author_id = a2



The rows are removed with the DELETE statement. The syntax of the DELETE statement looks like this, 


	DELETE FROM [TableName] <WHERE [Condition] >

Example

	DELETE FROM author WHERE author_id IN ("A2", "A3")



The rows to be removed are specified in the WHERE condition. Note that if you do not specify the WHERE clause, all the rows in the table will be removed. 















***********************  Information and Data Models


Entities: Are a group of Tables.


Atribute: Entities have attributes, which are the data elements that characterize the entity. Attributes tell us more about the entity. Entities can be a noun, person, place, or thing.


ERD: stands for "Entity Relationship Diagram". It represents a collection of entities and their relationships. The building blocks of an ER diagram are entities and attributes. In an ER diagram, an entity is drawn as a rectangle, and attributes are drawn as ovals.





ER model: stands for "Entity Relationship model" and it is used as a tool to design relational databases. In the ER model, entities are objects that exist independently of any other entities in the database. 




INFORMATION MODEL	 is an abstract formal representation of entities that includes their properties, relationships, and the operations that can be performed on them. The most familiar is the hierarchical, typically used to show organization charts. 



DATA MODELS 		are defined in a more concrete level, are specific, and include details. A data model is the blueprint of any database system. 



		NOTE 
		The relational model is the most used data model for databases, because this model allows for data independence. Data is stored in simple data structure tables. This provides logical data independence, physical data independence, and physical storage independence. 















***********************  types of relationships.


The building blocks of a relationship are: entities, relationship sets, and crows foot notations. Some "crows foot notations" are the greater than symbol, the less than symbol and a vertical line. 
 

Entity sets are represented by a rectangle. Relationship sets are represented by a diamond, with lines connecting associated entities and the corresponding "crows foot notations" relationship symbole in betwen. 



https://dev.to/helenanders26/entity-relationship-diagrams-explained-by-sonic-the-hedgehog-1m68















***********************  Relational Model Concepts. ( terms, relation, degree and cardinality ).


Relation: The building blocks of the relational model are relation and sets. A relation is a mathematical concept based on the idea of sets. 



Set: A set is an unordered collection of distinct elements. It is a collection of items of the same type.  It would have no order and no duplicates.  




difference between a relational schema and a relational instance. 



* A relational schema is the relation betwen the "Entities" and their corresponding "Atributes". specifies the name of a relation (colum name example "Author_ ID", "lastname", "firstname", etc...) and the attributes (data type that can be a char, varchar, etc...). 


* A relational instance are the table "VALUES" made up of the attributes or columns and the tuples or rows.



 
Degree: degree is a number and it refers to position of attributes or "COLUMNS element" in a relation.


Cardinality: Cardinality is a number and it refers to the position of the tuples or "ROWS element" in a relation..













*********************** Week 2 - Databases and SQL for Data Science ***********************

*********************** LAB: String Patterns, Sorting & Grouping ***********************




*** SQL LIKE Operator



SELECT column1, column2, ...
FROM table_name
WHERE columnN LIKE pattern;





		Query 1: Retrieve all employees whose address is in Elgin,IL


	select F_NAME, L_NAME  from  EMPLOYEES 
	where ADDRESS LIKE '%Elgin,IL'; 



		Query 2: Retrieve all employees who were born during the 1970's.


select F_NAME, L_NAME  from  EMPLOYEES 
where B_DATE LIKE '197%' 






https://www.w3schools.com/sql/sql_like.asp#:~:text=The%20SQL%20LIKE%20Operator,zero%2C%20one%2C%20or%20multiple%20characters




*** SQL BETWEEN Operator


SELECT column_name(s)
FROM table_name
WHERE column_name BETWEEN value1 AND value2;





		Query 3: Retrieve all employees in department 5 whose salary is between 60000 and 70000.


	select F_NAME, L_NAME  
	from  EMPLOYEES 
	where DEP_ID  = 5 and 
	SALARY BETWEEN 60000 and 70000




https://www.w3schools.com/sql/sql_between.asp




*** SQL ORDER BY Keyword



SELECT column1, column2, ...
FROM table_name
ORDER BY column1, column2, ... ASC|DESC;

And


SELECT column_name(s)
FROM table_name
WHERE condition
GROUP BY column_name(s)
ORDER BY column_name(s);



		Query 4A: Retrieve a list of employees ordered by department ID.


	select * from  EMPLOYEES 
	ORDER BY DEP_ID ASC;



		Query 4B: Retrieve a list of employees ordered in descending order by department ID and within each department ordered alphabetically in descending order by last name.



	select * from  EMPLOYEES 
	ORDER BY DEP_ID DESC and BY L_NAME DESC;





https://www.w3schools.com/sql/sql_orderby.asp#:~:text=The%20SQL%20ORDER%20BY%20Keyword,order%2C%20use%20the%20DESC%20keyword.




*** SQL COUNT() function and GROUP BY Syntax



COUNT(*)
COUNT( [ALL|DISTINCT] expression )



	select COUNT(*) from "tablename". 

		OR

	select DISTINCT ("columnname") from "tablename"






		Query 5A: For each department ID retrieve the number of employees in the department.


	select DEP_ID, COUNT(*) from EMPLOYEES 
	GROUP BY DEP_ID




https://www.w3schools.com/sql/sql_count_avg_sum.asp




***  SQL COUNT(), AVG() and SUM() Functions



SELECT AVG(column_name)
FROM table_name
WHERE condition;



		Query 5B: For each department retrieve the number of employees in the department, and the average employees salary in the department.


	SELECT DEP_ID, COUNT(*), AVG(SALARY) 
	FROM EMPLOYEES 
	GROUP BY DEP_ID





https://www.w3schools.com/sql/sql_count_avg_sum.asp#:~:text=The%20SQL%20COUNT()%2C%20AVG,value%20of%20a%20numeric%20column.






***   SQL AS Keyword


SELECT CustomerID AS ID, CustomerName AS Customer
FROM Table;




		Query 5C: Label the computed columns in the result set of Query 5B as “NUM_EMPLOYEES” and “AVG_SALARY”.


	SELECT DEP_ID, COUNT(*) AS NUM_EMPLOYEES, AVG(SALARY) AS AVG_SALARY 
	FROM EMPLOYEES 
	GROUP BY DEP_ID




https://www.w3schools.com/sql/sql_ref_as.asp







*** SQL ORDER BY Keyword  




SELECT column1, column2, ...
FROM table_name
ORDER BY column1, column2, ... ASC|DESC;



		Query 5D: In Query 5C order the result set by Average Salary.



	SELECT DEP_ID, COUNT(*) AS NUM_EMPLOYEES, AVG(SALARY) AS AVG_SALARY 
	FROM EMPLOYEES 
	GROUP BY DEP_ID 
	ORDER BY AVG(SALARY)





https://www.w3schools.com/sql/sql_orderby.asp#:~:text=The%20SQL%20ORDER%20BY%20Keyword,order%2C%20use%20the%20DESC%20keyword.







*** The SQL HAVING Clause



SELECT column_name(s)
FROM table_name
WHERE condition
GROUP BY column_name(s)
HAVING condition
ORDER BY column_name(s);





		Query 5E: In Query 5D limit the result to departments with fewer than 4 employees.




	SELECT DEP_ID, COUNT(*) AS NUM_EMPLOYEES, AVG(SALARY) AS AVG_SALARY 
	FROM EMPLOYEES 
	GROUP BY DEP_ID 
	HAVING COUNT(DEP_ID) < 5 
	ORDER BY AVG(SALARY);




https://www.w3schools.com/sql/sql_having.asp







***  SQL Aliases



BONUS 



SELECT o.OrderID, o.OrderDate, c.CustomerName
FROM Customers AS c, Orders AS o
WHERE c.CustomerName='Around the Horn' AND c.CustomerID=o.CustomerID;



		Query 6: Similar to 4B but instead of department ID use department name. Retrieve a list of employees ordered by department name, and within each department ordered alphabetically in descending order by last name.




	SELECT D.DEP_NAME, E.L_NAME 
	FROM EMPLOYEES AS E, DEPARTMENTS AS D
	WHERE E. DEP_ID  = D.DEPT_ID_DEP
	ORDER BY D.DEP_NAME, E.L_NAME DESC;



https://www.w3schools.com/sql/sql_alias.asp#:~:text=SQL%20aliases%20are%20used%20to,the%20duration%20of%20the%20query.





https://github.com/jorescal/Course/blob/master/LAB%20String%20Patterns%20Sorting%20%26%20Grouping.pdf













*********************** Built-in Database Functions



An aggregate function takes a collection of light values, such as all of the values in a column, as input, and returns a single value or null.Examples of aggregate functions include: sum, minimum, maximum, and average.




*****  Scalar functions perform operations on individual values. 


For example, 

	round up or down every value in the sale price column to the nearest integer, is shown as: 


select ROUND (SALEPRICE) from PETSALE 













*****  Uppercase and lowercase functions can be used to return uppercase or lowercase values of strings. 

For example: 


	retrieve animal values in uppercase is shown as: 

select UCASE (ANIMAL) from PETSALE



	or example, get lowercase values of the animal column for cat, is shown as: 

select * from PETSALE where LCASE(ANIMAL) = "cat" 













***** You can also have one function operate on the output of another function. 

For example, 

		get unique values for the animal column and uppercase is shown as: 


select DISTINCT (UCASE(ANIMAL)) from PETSALE 












********** Functions exist to extract the day, month, day of month, day of week, day of year, week, hour, minute, and second. *****



*****  The day function can be used to extract the day portion from a date. 

For example, 


	get the day portion for each sale date involving cat- is shown as, 


select DAY (SALEDATE) from PETSALE where ANIMAL = "cat"




	get the number of sales during the month of May, ie from Month 5- is shown as, 


select COUNT(*) from PETSALE where MONTH (SALEDATE) = 05




	what date is it three days after each sale date? 


select (SALEDATE + 3 DAYS) from PETSALE 




	find how many days have passed since each sale date till now- is shown as, 

select (CURRENT_DATE - SALEDATE) from PETSALE 

 




*********************** Writing sub-queries or nested selects statements.




	retrieve the list of employees who earn more than the average salary. 



***** sub-select expression



* WRONG *

Select * 
	from employees 
	where salary > AVG(salary).



* CORRECT *

Select EMP_ID, F_NAME, L_NAME, SALARY 
	from employees 
	where SALARY < ( select AVG (SALARY) from employees)







*****  column expression.



* WRONG *

select EMP_ID, SALARY, AVG(SALARY) AS AVG_SALARY 
	from employees.



* CORRECT *


select EMP_ID, SALARY, (select AVG(SALARY) from employees ) AS AVG_SALARY 
	from employees









*****  sub-query as part of the FROM clause (derived tables or table expressions). 


Select * from (select EMP_ID, F_NAME, L_NAME, DEP_ID 
		from employees) AS EMP4ALL



The derived table in a sub-query does not include sensitive fields like date of birth or salary.


Note

One of the limitations of built in aggregate functions, like the average function, is that they cannot always be evaluated in the WHERE clause.













*********************** Working with Multiple Tables



Select * 
	from employee, 
	where department_ID IN
		(select department_ID_department from departments);


Here the outer query accesses the employees table and the sub-query on the departments table is used for filtering the result set of the outer query.





Select * 
	from employee, 
	where department_ID IN 
		(select department_ID_department 
			from departments 
			where location ID = L0002 



Here we retrieved only the list of employees from a specific location. We do not have any location information in the employees table, but the departments table has a column called location ID. Therefore, we can use a sub-query from the Departments table as input to the employee table query.






Select department_ID_department, department_name 
	from department 
	where department_ID_department IN
		(select department_ID 
			from employees 
			where salary > 70,000;




Here we retrieve the department ID and department name for employees who earn more than $70,000











**************  SIMPLIFIED QUERY FOR MULTUPLE TABLES ****************



Select * 
	from employees, departments
	where employees.DEP_ID = departments.DEPT_ID_DEP; 




** SHORTER QUERY 


Select * 
	from employees E, departments D 
	where E.DEP_ID = D.DEPT_ID_DEP; 











**************  Relational Model Constraints


Within any business, data must often adhere to certain restrictions or rules. Constraints help implement the business rules. In a relational data model, data integrity can be achieved using integrity rules or constraints.

There are  six constraints in a relational database model. 

	* entity integrity constraint,
	* referential integrity constraint,
	* semantic integrity constraint,
	* domain constraint, 
	* null constraint,
	* check constraint. 

Constraints help implement the business rules.







************************************ Db2 on Cloud Lab *****************


Info requiered:



database name: Db2-zi


{
  "db": "BLUDB",
  "dsn": "DATABASE=BLUDB;HOSTNAME=dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net;PORT=50000;PROTOCOL=TCPIP;UID=cxw75041;PWD=8sqk@2r838wc6g7b;",
  "host": "dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net",
  "hostname": "dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net",
  "https_url": "https://dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net",
  "jdbcurl": "jdbc:db2://dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50000/BLUDB",
  "parameters": {
    "role_crn": "crn:v1:bluemix:public:iam::::serviceRole:Manager"
  },
  "password": "8sqk@2r838wc6g7b",
  "port": 50000,
  "ssldsn": "DATABASE=BLUDB;HOSTNAME=dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net;PORT=50001;PROTOCOL=TCPIP;UID=cxw75041;PWD=8sqk@2r838wc6g7b;Security=SSL;",
  "ssljdbcurl": "jdbc:db2://dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50001/BLUDB:sslConnection=true;",
  "uri": "db2://cxw75041:8sqk%402r838wc6g7b@dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50000/BLUDB",
  "username": "cxw75041"
}










Lab to be completed "Connect to Db2 database on Cloud using Python"





* Import the ibm_db Python library
* Enter the database connection credentials
* Create the database connection
* Close the database connection






*** Task 1 - Import the ibm_db Python library


	From Notebook run the following command;


import ibm_db



	When the command above completes, the ibm_db library is loaded in your notebook





*** Task 2 - Identify the database connection credentials



# Replace the placeholder values with your actual Db2 hostname, username, and password:


# For this lab we are gong to use the following credencials:


#Replace the placeholder values with the actuals for your Db2 Service Credentials

# dsn_driver = "{IBM DB2 ODBC DRIVER}"
# dsn_database = "BLUDB"            						# e.g. "BLUDB"
# dsn_hostname = "dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net"         # e.g.: "dashdb-txn-sbox-yp-dal09-# 04.services.dal.bluemix.net"
# dsn_port = "50000"                						# e.g. "50000" 
# dsn_protocol = "TCPIP"            						# i.e. "TCPIP"
# dsn_uid = "cxw75041"              						# e.g. "abc12345"
# dsn_pwd = "8sqk@2r838wc6g7b"      						# e.g. "7dBZ3wWt9XN6$o0J"




		*************	My Lab Case	*************	  


dsn_hostname = "YourDb2Hostname" 	# e.g.: "dashdb-txn-sbox-yp-dal09-04.services.dal.bluemix.net"
dsn_uid = "YourDb2Username"        	# e.g. "abc12345"
dsn_pwd = "YoueDb2Password"      	# e.g. "7dBZ3wWt9XN6$o0J"

dsn_driver = "{IBM DB2 ODBC DRIVER}"
dsn_database = "BLUDB"            	# e.g. "BLUDB"
dsn_port = "50000"                	# e.g. "50000" 
dsn_protocol = "TCPIP"            	# i.e. "TCPIP"








*** Task 3 - Create the DB2 database connection


#DO NOT MODIFY THIS CELL. Just RUN it with Shift + Enter

# 	Step A - Create the dsn connection string


dsn = (
    "DRIVER={0};"
    "DATABASE={1};"
    "HOSTNAME={2};"
    "PORT={3};"
    "PROTOCOL={4};"
    "UID={5};"
    "PWD={6};").format(dsn_driver, dsn_database, dsn_hostname, dsn_port, dsn_protocol, dsn_uid, dsn_pwd)


#print the connection string to check correct values are specified

print(dsn)



#	Step B - Now establish the connection to the database


#DO NOT MODIFY THIS CELL. Just RUN it with Shift + Enter
#Create database connection

try:
    conn = ibm_db.connect(dsn, "", "")
    print ("Connected to database: ", dsn_database, "as user: ", dsn_uid, "on host: ", dsn_hostname)

except:
    print ("Unable to connect: ", ibm_db.conn_errormsg() )




#	Step C - Now retrieve Metadata for the Database Server


server = ibm_db.server_info(conn)

print ("DBMS_NAME: ", server.DBMS_NAME)
print ("DBMS_VER:  ", server.DBMS_VER)
print ("DB_NAME:   ", server.DB_NAME)





#	Step D - Retrieve Metadata for the Database Client / Driver

client = ibm_db.client_info(conn)

print ("DRIVER_NAME:          ", client.DRIVER_NAME) 
print ("DRIVER_VER:           ", client.DRIVER_VER)
print ("DATA_SOURCE_NAME:     ", client.DATA_SOURCE_NAME)
print ("DRIVER_ODBC_VER:      ", client.DRIVER_ODBC_VER)
print ("ODBC_VER:             ", client.ODBC_VER)
print ("ODBC_SQL_CONFORMANCE: ", client.ODBC_SQL_CONFORMANCE)
print ("APPL_CODEPAGE:        ", client.APPL_CODEPAGE)
print ("CONN_CODEPAGE:        ", client.CONN_CODEPAGE)









**************** 	Access DB2 on Cloud using Python	**************** 




* Create a table "https://ibm.box.com/shared/static/ztd2cn4xkdoj5erlk4hhng39kbp63s1h.jpg"
* Insert data into the table
* Query data from the table
* Retrieve the result set into a pandas dataframe
* Close the database connection









*** TASK 4: Create a table in the database using Python


	# Step A - Lets first drop the table INSTRUCTOR in case it exists from a previous attempt

dropQuery = "drop table INSTRUCTOR"




    	#Now execute the drop statment

dropStmt = ibm_db.exec_immediate(conn, dropQuery)





### Dont worry if you get this error: INSTRUCTOR table does not exist in the table - which would be the case if you had not created it previously.






	#  Step B - Construct the Create Table DDL statement - replace the ... with rest of the statement



    	# CreateQuery = "create table INSTRUCTOR(id INTEGER PRIMARY KEY NOT NULL, fname ...)"

   	# Now fill in the name of the method and execute the statement

    	# CreateStmt = ibm_db.replace_with_name_of_execution_method(conn, createQuery)



createQuery = "create table INSTRUCTOR(ID INTEGER PRIMARY KEY NOT NULL, 
		FNAME VARCHAR(20), 
		LNAME VARCHAR(20), 
		CITY VARCHAR(20), 
		CCODE CHAR(2))"



createStmt = ibm_db.exec_immediate(conn,createQuery)








*** TASK 5: Insert data into the table using Python


insertQuery = "insert into INSTRUCTOR values 	(1, 
						'Rav', 
						'Ahuja', 
						'TORONTO', 
						'CA')"


insertStmt = ibm_db.exec_immediate (conn, insertQuery)



	# Now use a single query to insert the remaining two rows of data


insertQuery2 = "insert into INSTRUCTOR values 	(2, 
						'Raul', 
						'Chong', 
						'Markham', 
						'CA'), 

						(3, 
						'Hima', 
						'Vasudevan', 
						'Chicago', 
						'US')"


insertStmt2 = ibm_db.exec_immediate (conn, insertQuery2)








*** TASK 6: Query data in the table using Python





	# Construct the query that retrieves all rows from the INSTRUCTOR table

selectQuery = "select * from INSTRUCTOR"





	# Execute the statement

selectStmt = ibm_db.exec_immediate(conn, selectQuery)





	# Fetch the Dictionary (for the first row only * ) 

ibm_db.fetch_both(selectStmt)





	# Fetch the rest of the rows and print the ID and FNAME for those rows

while ibm_db.fetch_row(selectStmt) != False:
   print (" ID:",  ibm_db.result(selectStmt, 0), " FNAME:",  ibm_db.result(selectStmt, "FNAME"))





	# now write and execute an update statement that changes the Rav's CITY to MOOSETOWN ( UPDATE [TableName] SET [ColumnName] = [Value] ]> <WHERE [Condition] > ). 	

updateQuery = "update INSTRUCTOR set CITY='MOOSETOWN' where FNAME='Rav'"
updateStmt = ibm_db.exec_immediate(conn, updateQuery))









*** TASK 7: Retrieve data into Pandas


import pandas
import ibm_db_dbi





	# connection for pandas

pconn = ibm_db_dbi.Connection(conn)






	# query statement to retrieve all rows in INSTRUCTOR table

selectQuery = "select * from INSTRUCTOR"





	# retrieve the query results into a pandas dataframe

pdf = pandas.read_sql(selectQuery, pconn)





	# print just the LNAME for first row in the pandas data frame

pdf.LNAME[0]





	# print the entire data frame
pdf

	# Once the data is in a Pandas dataframe, you can do the typical pandas operations on it.
	# For example you can use the shape method to see how many rows and columns are in the dataframe`

pdf.shape





***  Task 8: Close the Connection


ibm_db.close(conn)








**************** 	Accessing Databases with SQL Magic	**************** 	




	# To communicate with SQL Databases from within a JupyterLab notebook, we can use the SQL "magic" provided by the ipython-sql extension. "Magic" is JupyterLab's term for special commands 		# that start with "%". Below, we'll use the load___ext magic to load the ipython-sql extension.



%load_ext sql




	# retrieve or create your credentials "uri":" to access your Db2 database.




{
  "db": "BLUDB",
  "dsn": "DATABASE=BLUDB;HOSTNAME=dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net;PORT=50000;PROTOCOL=TCPIP;UID=cxw75041;PWD=8sqk@2r838wc6g7b;",
  "host": "dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net",
  "hostname": "dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net",
  "https_url": "https://dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net",
  "jdbcurl": "jdbc:db2://dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50000/BLUDB",
  "parameters": {
    "role_crn": "crn:v1:bluemix:public:iam::::serviceRole:Manager"
  },
  "password": "8sqk@2r838wc6g7b",
  "port": 50000,
  "ssldsn": "DATABASE=BLUDB;HOSTNAME=dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net;PORT=50001;PROTOCOL=TCPIP;UID=cxw75041;PWD=8sqk@2r838wc6g7b;Security=SSL;",
  "ssljdbcurl": "jdbc:db2://dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50001/BLUDB:sslConnection=true;",
  "uri": "db2://cxw75041:8sqk%402r838wc6g7b@dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50000/BLUDB",
  "username": "cxw75041"
}



	# Note the "ibm_db_sa://" prefix instead of "db2://"
	# This is because JupyterLab's ipython-sql extension uses sqlalchemy (a python SQL toolkit)
	# which in turn uses IBM's sqlalchemy dialect: ibm_db_sa



%sql ibm_db_sa://cxw75041:8sqk%402r838wc6g7b@dashdb-txn-sbox-yp-dal09-08.services.dal.bluemix.net:50000/BLUDB



	# For convenience, we can use %%sql (two %'s instead of one) at the top of a cell to indicate we want the entire cell to be 		
	# treated as SQL. Let's use this to create a table and fill it with some test data for experimenting.





%%sql

CREATE TABLE INTERNATIONAL_STUDENT_TEST_SCORES (
	country VARCHAR(50),
	first_name VARCHAR(50),
	last_name VARCHAR(50),
	test_score INT);





INSERT INTO INTERNATIONAL_STUDENT_TEST_SCORES (country, first_name, last_name, test_score)
					VALUES
					('United States', 'Marshall', 'Bernadot', 54),
					('Ghana', 'Celinda', 'Malkin', 51),
					('Ukraine', 'Guillermo', 'Furze', 53),
					('Greece', 'Aharon', 'Tunnow', 48),
					('Russia', 'Bail', 'Goodwin', 46),
					('Poland', 'Cole', 'Winteringham', 49),
					('Sweden', 'Emlyn', 'Erricker', 55),
					('Russia', 'Cathee', 'Sivewright', 49),
					('China', 'Barny', 'Ingerson', 57),
					('Uganda', 'Sharla', 'Papaccio', 55),
					('China', 'Stella', 'Youens', 51),
					('Poland', 'Julio', 'Buesden', 48),
					('United States', 'Tiffie', 'Cosely', 58),
					('Poland', 'Auroora', 'Stiffell', 45),
					('China', 'Clarita', 'Huet', 52),
					('Poland', 'Shannon', 'Goulden', 45),
					('Philippines', 'Emylee', 'Privost', 50),
					('France', 'Madelina', 'Burk', 49),
					('China', 'Saunderson', 'Root', 58),
					('Indonesia', 'Bo', 'Waring', 55),
					('China', 'Hollis', 'Domotor', 45),
					('Russia', 'Robbie', 'Collip', 46),
					('Philippines', 'Davon', 'Donisi', 46),
					('China', 'Cristabel', 'Radeliffe', 48),
					('China', 'Wallis', 'Bartleet', 58),
					('Moldova', 'Arleen', 'Stailey', 38),
					('Ireland', 'Mendel', 'Grumble', 58),
					('China', 'Sallyann', 'Exley', 51),
					('Mexico', 'Kain', 'Swaite', 46),
					('Indonesia', 'Alonso', 'Bulteel', 45),
					('Armenia', 'Anatol', 'Tankus', 51),
					('Indonesia', 'Coralyn', 'Dawkins', 48),
					('China', 'Deanne', 'Edwinson', 45),
					('China', 'Georgiana', 'Epple', 51),
					('Portugal', 'Bartlet', 'Breese', 56),
					('Azerbaijan', 'Idalina', 'Lukash', 50),
					('France', 'Livvie', 'Flory', 54),
					('Malaysia', 'Nonie', 'Borit', 48),
					('Indonesia', 'Clio', 'Mugg', 47),
					('Brazil', 'Westley', 'Measor', 48),
					('Philippines', 'Katrinka', 'Sibbert', 51),
					('Poland', 'Valentia', 'Mounch', 50),
					('Norway', 'Sheilah', 'Hedditch', 53),
					('Papua New Guinea', 'Itch', 'Jubb', 50),
					('Latvia', 'Stesha', 'Garnson', 53),
					('Canada', 'Cristionna', 'Wadmore', 46),
					('China', 'Lianna', 'Gatward', 43),
					('Guatemala', 'Tanney', 'Vials', 48),
					('France', 'Alma', 'Zavittieri', 44),
					('China', 'Alvira', 'Tamas', 50),
					('United States', 'Shanon', 'Peres', 45),
					('Sweden', 'Maisey', 'Lynas', 53),
					('Indonesia', 'Kip', 'Hothersall', 46),
					('China', 'Cash', 'Landis', 48),
					('Panama', 'Kennith', 'Digance', 45),
					('China', 'Ulberto', 'Riggeard', 48),
					('Switzerland', 'Judy', 'Gilligan', 49),
					('Philippines', 'Tod', 'Trevaskus', 52),
					('Brazil', 'Herold', 'Heggs', 44),
					('Latvia', 'Verney', 'Note', 50),
					('Poland', 'Temp', 'Ribey', 50),
					('China', 'Conroy', 'Egdal', 48),
					('Japan', 'Gabie', 'Alessandone', 47),
					('Ukraine', 'Devlen', 'Chaperlin', 54),
					('France', 'Babbette', 'Turner', 51),
					('Czech Republic', 'Virgil', 'Scotney', 52),
					('Tajikistan', 'Zorina', 'Bedow', 49),
					('China', 'Aidan', 'Rudeyeard', 50),
					('Ireland', 'Saunder', 'MacLice', 48),
					('France', 'Waly', 'Brunstan', 53),
					('China', 'Gisele', 'Enns', 52),
					('Peru', 'Mina', 'Winchester', 48),
					('Japan', 'Torie', 'MacShirrie', 50),
					('Russia', 'Benjamen', 'Kenford', 51),
					('China', 'Etan', 'Burn', 53),
					('Russia', 'Merralee', 'Chaperlin', 38),
					('Indonesia', 'Lanny', 'Malam', 49),
					('Canada', 'Wilhelm', 'Deeprose', 54),
					('Czech Republic', 'Lari', 'Hillhouse', 48),
					('China', 'Ossie', 'Woodley', 52),
					('Macedonia', 'April', 'Tyer', 50),
					('Vietnam', 'Madelon', 'Dansey', 53),
					('Ukraine', 'Korella', 'McNamee', 52),
					('Jamaica', 'Linnea', 'Cannam', 43),
					('China', 'Mart', 'Coling', 52),
					('Indonesia', 'Marna', 'Causbey', 47),
					('China', 'Berni', 'Daintier', 55),
					('Poland', 'Cynthia', 'Hassell', 49),
					('Canada', 'Carma', 'Schule', 49),
					('Indonesia', 'Malia', 'Blight', 48),
					('China', 'Paulo', 'Seivertsen', 47),
					('Niger', 'Kaylee', 'Hearley', 54),
					('Japan', 'Maure', 'Jandak', 46),
					('Argentina', 'Foss', 'Feavers', 45),
					('Venezuela', 'Ron', 'Leggitt', 60),
					('Russia', 'Flint', 'Gokes', 40),
					('China', 'Linet', 'Conelly', 52),
					('Philippines', 'Nikolas', 'Birtwell', 57),
					('Australia', 'Eduard', 'Leipelt', 53)



	# You can use python variables in your SQL statements by adding a ":" prefix to your python variable names.
	# For example, if I have a python variable country with a value of "Canada", I can use this variable in a SQL query to find 		
	# all the rows of students from Canada.








*** Using Python Variables in your SQL Statements

country = "Canada"
%sql select * from INTERNATIONAL_STUDENT_TEST_SCORES where country = :country




country		first_name		last_name	test_score

Canada		Cristionna		Wadmore		46
Canada		Wilhelm			Deeprose	54
Canada		Carma			Schule		49









***  Assigning the Results of Queries to Python Variables

	# You can use the normal python assignment syntax to assign the results of your queries to python variables.
	# For example, I have a SQL query to retrieve the distribution of test scores (i.e. how many students got each score). I can 	
	# assign the result of this query to the variable test_score_distribution using the = operator.




test_score_distribution = %sql SELECT test_score as "Test Score", count(*) as "Frequency" from INTERNATIONAL_STUDENT_TEST_SCORES GROUP BY test_score;
test_score_distribution


Test Score	Frequency
38		2
40		1
43		2
44		2
45		8
46		7
47		4
48		14
49		8
50		10
51		8
52		8
53		8
54		5
55		4
56		1
57		2
58		4
60		1






*** Converting Query Results to DataFrames


	# You can easily convert a SQL query result to a pandas dataframe using the DataFrame() method. Dataframe objects are much more versatile than 		
	# SQL query result objects. For example, we can easily graph our test score distribution after converting to a dataframe.




dataframe = test_score_distribution.DataFrame()



%matplotlib inline

	# uncomment the following line if you get an module error saying seaborn not found
	# !pip install seaborn


import seaborn

plot = seaborn.barplot(x='Test Score',y='Frequency', data=dataframe)












*** *** *** *** *** Load CSV files into IBM DB2 database *** *** *** *** *** 




https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DB0201EN-SkillsNetwork/labs/FinalModule_SKO/Reading_Loading_Data.md.html













*** *** *** *** *** QUERYS TO PULL DATA TABLES INFORMATION FROM YOUR IBM CLOUD DATA BASE ***  *** *** *** *** 


	# TO KNOW TABLE NAMES ON A Db2 DATA BASE RUNN  THE FOLLOWING COMMAND (YOU NEED TO FIND THE "username" CREDENTIAL ON YOUR dB2 STORAGE, IN THIS CASE IT IS "username": "cxw75041")

%sql select TABSCHEMA, TABNAME, CREATE_TIME from SYSCAT.TABLES where TABSCHEMA='cxw75041'





	# TO FIND THE TABLES THAT INCLUDE COLUM NAME = TO..."DOG":


%sql select count(*) from SYSCAT.COLUMNS where TABNAME = 'DOG'


%sql select COLNAME, TYPENAME, LENGTH from SYSCAT.COLUMNS where TABNAME = 'DOG'

or

%sql select distinct(NAME), COLTYPE, LENGTH from SYSIBM.SYSCOLUMNS where TBNAME = 'DOG'

















